# 🏠 本地自動監控設置指南

由於 Canvas 遊戲的反自動化檢測過強，GitHub Actions 無法正常檢測圖片（只能檢測到 2 張而不是 96 張）。

本指南將幫助你在本地電腦上設置自動監控，每天自動運行並推送結果到 GitHub Pages。

---

## ✅ 優勢

- **準確率 100%** - 本地運行已確認可以檢測到 96 張圖片
- **完全免費** - 不需要任何付費服務
- **自動推送** - 結果自動顯示在 GitHub Pages
- **簡單設置** - 只需 5 分鐘

## 📋 前置條件

- ✅ Node.js 已安裝
- ✅ Git 已配置（可以 push 到 GitHub）
- ✅ `.env` 文件已配置好 `MONITOR_URL`

---

## 🚀 快速設置（5 分鐘）

### 步驟 1：測試運行

先確保腳本能正常運行：

1. 打開命令提示字元（cmd）
2. 進入專案目錄：
   ```cmd
   cd C:\Users\dada.ho.REVO\website-monitor
   ```
3. 運行測試：
   ```cmd
   node run-and-push.js
   ```

**預期結果：**
- 瀏覽器會打開
- 等待 2.5 分鐘
- 顯示檢測到 ~96 張圖片
- 自動提交並推送到 GitHub
- 結果會顯示在 https://dadazax.github.io/detect-dealer/

### 步驟 2：設置 Windows 任務計劃程序

#### 方法 A：使用快捷方式（推薦）

1. **按 `Win + R`**，輸入 `taskschd.msc`，按 Enter
2. 點擊右側 **「創建基本工作」**
3. **名稱**：`網站監控 - 早上`
4. **描述**：`每天早上 9 點運行網站監控`
5. 點擊 **「下一步」**

#### 觸發器設置：

6. 選擇 **「每天」**，點擊 **「下一步」**
7. **開始**：選擇今天的日期
8. **時間**：輸入 `09:00:00`（早上 9 點）
9. **重複間隔**：每天 1 次
10. 點擊 **「下一步」**

#### 動作設置：

11. 選擇 **「啟動程式」**，點擊 **「下一步」**
12. **程式或指令碼**：瀏覽並選擇
    ```
    C:\Users\dada.ho.REVO\website-monitor\run-monitor.bat
    ```
13. **起始於（選擇性）**：
    ```
    C:\Users\dada.ho.REVO\website-monitor
    ```
14. 點擊 **「下一步」**
15. 點擊 **「完成」**

#### 重複步驟創建晚上任務：

16. 再創建一個任務，名稱改為 `網站監控 - 晚上`
17. 時間改為 `21:00:00`（晚上 9 點）

---

## 🧪 測試自動任務

你可以手動觸發任務來測試：

1. 在任務計劃程序中，找到你創建的任務
2. 右鍵點擊 → **「執行」**
3. 觀察任務是否正常運行
4. 檢查 GitHub Pages 是否更新

---

## ⚙️ 進階設置（可選）

### 設置條件（省電模式）

如果你希望電腦在待機時不運行：

1. 雙擊任務 → **「條件」** 標籤
2. 勾選 **「只有在電腦使用 AC 電源時才啟動此工作」**
3. 取消勾選 **「如果電腦在使用電池電源時...」**

### 設置郵件通知（需要配置）

如果想在檢測到錯誤時收到郵件：

在腳本中可以添加發送郵件的邏輯，但目前已經有 Telegram 通知了。

---

## 📊 監控結果

運行後，結果會自動顯示在：
- **GitHub Pages**: https://dadazax.github.io/detect-dealer/
- **數據文件**: `docs/data/latest.json` 和 `docs/data/history.json`

---

## ❓ 常見問題

### Q: 電腦需要一直開機嗎？
**A**: 是的，在檢查時間（早上 9 點和晚上 9 點）電腦需要開機。但可以在休眠/睡眠狀態，任務會喚醒電腦。

### Q: 我不在電腦前，任務會運行嗎？
**A**: 會！只要電腦開機且已登入 Windows，任務會在背景自動運行。

### Q: 瀏覽器會彈出嗎？
**A**: 會！瀏覽器會可見地打開 2.5 分鐘。如果你不想被干擾，可以在任務運行時不使用電腦。

### Q: 可以手動運行嗎？
**A**: 可以！直接雙擊 `run-monitor.bat` 或運行 `node run-and-push.js`。

### Q: 如何查看日誌？
**A**:
1. 打開任務計劃程序
2. 找到任務 → 右鍵 → **「內容」**
3. **「歷程記錄」** 標籤可以看到運行記錄

### Q: GitHub Actions 還需要保留嗎？
**A**: 可以保留或停用。如果停用，可以刪除 `.github/workflows/monitor.yml` 或修改 schedule。

---

## 🔧 維護

### 停止自動運行

1. 打開任務計劃程序
2. 找到任務 → 右鍵 → **「停用」** 或 **「刪除」**

### 修改運行時間

1. 雙擊任務 → **「觸發程序」** 標籤
2. 選擇觸發程序 → **「編輯」**
3. 修改時間 → **「確定」**

### 查看錯誤

如果任務失敗，檢查：
1. `run-monitor.bat` 是否存在
2. Node.js 是否正確安裝
3. `.env` 文件是否配置正確
4. Git 是否能正常 push

---

## 🎉 完成！

設置完成後，系統會：
- 每天早上 9 點自動檢查
- 每天晚上 9 點自動檢查
- 自動推送結果到 GitHub
- 結果顯示在 GitHub Pages
- 如有錯誤，Telegram 會收到通知

你只需要確保電腦在檢查時間保持開機！

---

需要幫助？查看：
- [GitHub Issues](https://github.com/dadazax/detect-dealer/issues)
- [Windows 任務計劃程序文檔](https://docs.microsoft.com/zh-tw/windows/win32/taskschd/task-scheduler-start-page)
